---
interface Props {
  id: string;
  title: string;
  description: string;
  uploadDate?: string; // Format YYYY-MM-DD (converti automatiquement en ISO 8601 avec fuseau horaire)
}

const { id, title, description, uploadDate } = Astro.props;

const schema: Record<string, unknown> = {
  "@context": "https://schema.org",
  "@type": "VideoObject",
  name: title,
  description: description,
  thumbnailUrl: `https://i.ytimg.com/vi/${id}/maxresdefault.jpg`,
  embedUrl: `https://www.youtube.com/embed/${id}`,
  contentUrl: `https://www.youtube.com/watch?v=${id}`
};

// Ajouter uploadDate seulement si fourni (format ISO 8601 avec fuseau horaire)
if (uploadDate) {
  // Si la date est au format YYYY-MM-DD, ajouter l'heure et le fuseau horaire UTC
  schema.uploadDate = uploadDate.includes('T') ? uploadDate : `${uploadDate}T00:00:00+00:00`;
}
---

<div class="video-container">
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
  <iframe
    src={`https://www.youtube.com/embed/${id}`}
    title={title}
    loading="lazy"
    allowfullscreen
  ></iframe>
</div>

<style>
  .video-container {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
    margin: 1.5rem 0;
    border-radius: 8px;
  }
  .video-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }
</style>
